"use strict";(self.webpackChunkrm_controls_docs=self.webpackChunkrm_controls_docs||[]).push([[684],{3905:function(e,t,r){r.d(t,{Zo:function(){return c},kt:function(){return m}});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),d=p(r),m=i,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return r?n.createElement(h,l(l({ref:t},c),{},{components:r})):n.createElement(h,l({ref:t},c))}));function m(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=r.length,l=new Array(o);l[0]=d;var a={};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);a.originalType=e,a.mdxType="string"==typeof e?e:i,l[1]=a;for(var p=2;p<o;p++)l[p]=r[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2527:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return a},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var n=r(7462),i=r(3366),o=(r(7294),r(3905)),l=["components"],a={},s="rm_shooter_controller",p={unversionedId:"digging_deeper/controllers/rm_shooter_controllers",id:"digging_deeper/controllers/rm_shooter_controllers",isDocsHomePage:!1,title:"rm_shooter_controller",description:"1. Overview",source:"@site/current_docs/digging_deeper/controllers/rm_shooter_controllers.md",sourceDirName:"digging_deeper/controllers",slug:"/digging_deeper/controllers/rm_shooter_controllers",permalink:"/digging_deeper/controllers/rm_shooter_controllers",editUrl:"https://github.com/rm-controls/rm-controls.github.io/tree/master/current_docs/digging_deeper/controllers/rm_shooter_controllers.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"rm_gimbal_controllers",permalink:"/digging_deeper/controllers/rm_gimbal_controllers"},next:{title:"\u8f6f\u4ef6\u5e95\u76d8\u529f\u7387\u9650\u5236",permalink:"/digging_deeper/theory/software_power_limit"}},c=[{value:"1. Overview",id:"1-overview",children:[{value:"1.1. Hardware interface type",id:"11-hardware-interface-type",children:[]}]},{value:"2. Installation",id:"2-installation",children:[{value:"2.1. Installation from Packages",id:"21-installation-from-packages",children:[]},{value:"2.2. Building from Source",id:"22-building-from-source",children:[]}]},{value:"3. Usage",id:"3-usage",children:[]},{value:"4. Cfg",id:"4-cfg",children:[]},{value:"5. Launch files",id:"5-launch-files",children:[]},{value:"6. ROS API",id:"6-ros-api",children:[{value:"7. Controller configuration examples",id:"7-controller-configuration-examples",children:[]}]},{value:"8. Bugs &amp; Feature Requests",id:"8-bugs--feature-requests",children:[]}],u={toc:c};function d(e){var t=e.components,r=(0,i.Z)(e,l);return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"rm_shooter_controller"},"rm_shooter_controller"),(0,o.kt)("h2",{id:"1-overview"},"1. Overview"),(0,o.kt)("p",null,"The controller is RoboMaster robot shooter controller. It is used for reading joint sensor data and sending command to motors. Besides , It will calls control loop (update method) periodically at a set frequency ."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Keywords:")," shooter"),(0,o.kt)("h4",{id:"license"},"License"),(0,o.kt)("p",null,"The source code is released under a ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/rm-controls/rm_controllers/blob/master/LICENSE"},"BSD 3-Clause license"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Author: DynamicX")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Affiliation: DynamicX")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Maintainer: DynamicX")),(0,o.kt)("p",null,"The rm_shooter_controller package has been tested under ",(0,o.kt)("a",{parentName:"p",href:"http://www.ros.org"},"ROS")," Melodic and Noetic on respectively 18.04 and 20.04. This is research code, expect that it changes often and any fitness for a particular purpose is disclaimed."),(0,o.kt)("h3",{id:"11-hardware-interface-type"},"1.1. Hardware interface type"),(0,o.kt)("p",null,"The controller works with friction wheel joints through a ",(0,o.kt)("strong",{parentName:"p"},"effort")," interface."),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"http://rsl-ci.ethz.ch/job/ros_best_practices/"},(0,o.kt)("img",{parentName:"a",src:"http://rsl-ci.ethz.ch/buildStatus/icon?job=ros_best_practices",alt:"Build Status"}))),(0,o.kt)("h2",{id:"2-installation"},"2. Installation"),(0,o.kt)("h3",{id:"21-installation-from-packages"},"2.1. Installation from Packages"),(0,o.kt)("p",null,"To install all packages from the this repository as Debian packages use"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-plaintext"},"sudo apt-get install ros-noetic-rm-shooter-controllers\n")),(0,o.kt)("p",null,"or better use ",(0,o.kt)("inlineCode",{parentName:"p"},"rosdep"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"sudo rosdep install --from-paths src\n")),(0,o.kt)("h3",{id:"22-building-from-source"},"2.2. Building from Source"),(0,o.kt)("h4",{id:"221-dependencies"},"2.2.1 Dependencies"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://wiki.ros.org/"},"Robot Operating System (ROS)")," (middleware for robotics),"),(0,o.kt)("li",{parentName:"ul"},"rm_description"),(0,o.kt)("li",{parentName:"ul"},"roscpp"),(0,o.kt)("li",{parentName:"ul"},"roslint"),(0,o.kt)("li",{parentName:"ul"},"rm_msgs"),(0,o.kt)("li",{parentName:"ul"},"rm_common"),(0,o.kt)("li",{parentName:"ul"},"pluginlib"),(0,o.kt)("li",{parentName:"ul"},"controller_interface"),(0,o.kt)("li",{parentName:"ul"},"hardware_interface"),(0,o.kt)("li",{parentName:"ul"},"controller_interface"),(0,o.kt)("li",{parentName:"ul"},"forward_command_controller"),(0,o.kt)("li",{parentName:"ul"},"realtime_tools"),(0,o.kt)("li",{parentName:"ul"},"control_toolbox"),(0,o.kt)("li",{parentName:"ul"},"effort_controllers"),(0,o.kt)("li",{parentName:"ul"},"dynamic_reconfigure")),(0,o.kt)("h4",{id:"222-building"},"2.2.2 Building"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Build this package with catkin build. Clone the latest version from this repository into your catkin workspace.")),(0,o.kt)("h2",{id:"3-usage"},"3. Usage"),(0,o.kt)("p",null,"Run the controller with mon launch:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"mon launch rm_shooter_controller load_controllers.launch\n")),(0,o.kt)("h2",{id:"4-cfg"},"4. Cfg"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"shooter.cfg:")," Add parameters related to friction wheel speed corresponding to each bullet speed and trigger block detection parameters")),(0,o.kt)("h2",{id:"5-launch-files"},"5. Launch files"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"load_controller.launch:")," Load the parameters in config files and load the shooter controller.")),(0,o.kt)("h2",{id:"6-ros-api"},"6. ROS API"),(0,o.kt)("h4",{id:"61-subscribed-topics"},"6.1. Subscribed Topics"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"command"),"(rm_msgs/ShootCmd)"),(0,o.kt)("p",{parentName:"li"},"Commands of controller state, bullet speed, frequency of shooting, and time stamp."))),(0,o.kt)("h4",{id:"62-parameters"},"6.2. Parameters"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"block_effort"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"block_speed"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"block_duration")," (",(0,o.kt)("inlineCode",{parentName:"p"},"double"),", default: 0)"),(0,o.kt)("p",{parentName:"li"},"When the torque of the plucking motor is greater than block_effort (in N\xb7m), and the angular velocity is less than block_speed (in rad/s), it will be regarded as jamming if it continues for block_duration (in s).")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"block_overtime")," (",(0,o.kt)("inlineCode",{parentName:"p"},"double"),", default: 0)"),(0,o.kt)("p",{parentName:"li"},"If the time to enter block state exceeds block_overtime (in s), it will be judged as timeout and exit block state.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"anti_block_angle")," (",(0,o.kt)("inlineCode",{parentName:"p"},"double"),", default: 0)"),(0,o.kt)("p",{parentName:"li"},"If enter block state, the friction wheel will reverse anti_block_angle (in rad/s) to try to get rid of the structing.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"anti_block_threshold")," (",(0,o.kt)("inlineCode",{parentName:"p"},"double"),", default: 0)"),(0,o.kt)("p",{parentName:"li"},"If the anti angle of the friction wheel exceeds anti_block_threshold, it means that trigger reverse success.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"qd_10"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"qd_15"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"qd_18"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"qd_30"),"(",(0,o.kt)("inlineCode",{parentName:"p"},"double"),")"),(0,o.kt)("p",{parentName:"li"},"It means friction wheel's angular velocity, the number of it's name expresses different bullet speeds (in m/s)."))),(0,o.kt)("h3",{id:"7-controller-configuration-examples"},"7. Controller configuration examples"),(0,o.kt)("h4",{id:"71-minimal-description"},"7.1. Minimal description"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'shooter_controller:\n    type: rm_shooter_controllers/Controller\n    publish_rate: 50\n    friction_left:\n      joint: "left_friction_wheel_joint"\n      pid: { p: 0.001, i: 0.01, d: 0.0, i_clamp_max: 0.01, i_clamp_min: -0.01, antiwindup: true, publish_state: true }\n    friction_right:\n      joint: "right_friction_wheel_joint"\n      pid: { p: 0.001, i: 0.01, d: 0.0, i_clamp_max: 0.01, i_clamp_min: -0.01, antiwindup: true, publish_state: true }\n    trigger:\n      joint: "trigger_joint"\n      pid: { p: 50.0, i: 0.0, d: 1.5, i_clamp_max: 0.0, i_clamp_min: 0.0, antiwindup: true, publish_state: true }\n')),(0,o.kt)("h4",{id:"72-complete-description"},"7.2. Complete description"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'shooter_controller:\n    type: rm_shooter_controllers/Controller\n    publish_rate: 50\n    friction_left:\n      joint: "left_friction_wheel_joint"\n      pid: { p: 0.001, i: 0.01, d: 0.0, i_clamp_max: 0.01, i_clamp_min: -0.01, antiwindup: true, publish_state: true }\n    friction_right:\n      joint: "right_friction_wheel_joint"\n      pid: { p: 0.001, i: 0.01, d: 0.0, i_clamp_max: 0.01, i_clamp_min: -0.01, antiwindup: true, publish_state: true }\n    trigger:\n      joint: "trigger_joint"\n      pid: { p: 50.0, i: 0.0, d: 1.5, i_clamp_max: 0.0, i_clamp_min: 0.0, antiwindup: true, publish_state: true }\n    push_per_rotation: 8\n    push_qd_threshold: 0.90\n    block_effort: 0.95\n    block_duration: 0.05\n    block_overtime: 0.5\n    anti_block_angle: 0.2\n    anti_block_threshold: 0.1\n    qd_15: 460.0\n    qd_18: 515.0\n    qd_30: 740.0\n')),(0,o.kt)("h2",{id:"8-bugs--feature-requests"},"8. Bugs & Feature Requests"),(0,o.kt)("p",null,"Please report bugs and request features using the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/gdut-dynamic-x/simple_chassis_controller/issues"},"Issue Tracker")," ."))}d.isMDXComponent=!0}}]);