"use strict";(self.webpackChunkrm_controls_docs=self.webpackChunkrm_controls_docs||[]).push([[684],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return m}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,l=e.originalType,s=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),d=c(r),m=o,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||l;return r?n.createElement(h,i(i({ref:t},p),{},{components:r})):n.createElement(h,i({ref:t},p))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var l=r.length,i=new Array(l);i[0]=d;var a={};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);a.originalType=e,a.mdxType="string"==typeof e?e:o,i[1]=a;for(var c=2;c<l;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2527:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return a},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return p},default:function(){return d}});var n=r(7462),o=r(3366),l=(r(7294),r(3905)),i=["components"],a={},s="rm_shooter_controller",c={unversionedId:"digging_deeper/controllers/rm_shooter_controllers",id:"digging_deeper/controllers/rm_shooter_controllers",isDocsHomePage:!1,title:"rm_shooter_controller",description:"Overview",source:"@site/current_docs/digging_deeper/controllers/rm_shooter_controllers.md",sourceDirName:"digging_deeper/controllers",slug:"/digging_deeper/controllers/rm_shooter_controllers",permalink:"/en/digging_deeper/controllers/rm_shooter_controllers",editUrl:"https://github.com/rm-controls/rm-controls.github.io/tree/master/current_docs/digging_deeper/controllers/rm_shooter_controllers.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"rm_gimbal_controllers",permalink:"/en/digging_deeper/controllers/rm_gimbal_controllers"},next:{title:"\u8f6f\u4ef6\u5e95\u76d8\u529f\u7387\u9650\u5236",permalink:"/en/digging_deeper/theory/software_power_limit"}},p=[{value:"Overview",id:"overview",children:[{value:"Hardware interface type",id:"hardware-interface-type",children:[]}]},{value:"Installation",id:"installation",children:[{value:"Installation from Packages",id:"installation-from-packages",children:[]},{value:"Building from Source",id:"building-from-source",children:[]}]},{value:"Usage",id:"usage",children:[]},{value:"Cfg",id:"cfg",children:[]},{value:"Launch files",id:"launch-files",children:[]},{value:"ROS API",id:"ros-api",children:[{value:"Controller configuration examples",id:"controller-configuration-examples",children:[]}]},{value:"Bugs &amp; Feature Requests",id:"bugs--feature-requests",children:[]}],u={toc:p};function d(e){var t=e.components,r=(0,o.Z)(e,i);return(0,l.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"rm_shooter_controller"},"rm_shooter_controller"),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"The rm_shooter_controller has four states: STOP, READY, PUSH, and BLOCK, it controls the left and right friction wheels and the trigger wheel through PID algorithm according to the command. It can set the bullet speed by setting the angular velocity of the friction wheel, and at the same time realizes the block detection."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Keywords:")," ROS, robomaster, shooter"),(0,l.kt)("h4",{id:"license"},"License"),(0,l.kt)("p",null,"The source code is released under a ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/rm-controls/rm_controllers/blob/master/LICENSE"},"BSD 3-Clause license"),"."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Author: DynamicX",(0,l.kt)("br",null),"\nAffiliation: DynamicX",(0,l.kt)("br",null),"\nMaintainer: DynamicX")),(0,l.kt)("p",null,"The rm_shooter_controller package has been tested under ",(0,l.kt)("a",{parentName:"p",href:"http://www.ros.org"},"ROS")," Melodic and Noetic on respectively 18.04 and 20.04. This is research code, expect that it changes often and any fitness for a particular purpose is disclaimed."),(0,l.kt)("h3",{id:"hardware-interface-type"},"Hardware interface type"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"JointStateInterface")," Used to obtain the speed of friction wheel and trigger wheel and the position of trigger wheel."),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"EffortJointInterface")," Used to send torque commands for friction wheels and trigger wheel.")),(0,l.kt)("h2",{id:"installation"},"Installation"),(0,l.kt)("h3",{id:"installation-from-packages"},"Installation from Packages"),(0,l.kt)("p",null,"To install all packages from this repository as Debian packages use"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo apt-get install ros-noetic-rm-shooter-controllers\n")),(0,l.kt)("p",null,"or better use ",(0,l.kt)("inlineCode",{parentName:"p"},"rosdep"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"sudo rosdep install --from-paths src\n")),(0,l.kt)("h3",{id:"building-from-source"},"Building from Source"),(0,l.kt)("h4",{id:"dependencies"},"Dependencies"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"rm_description"),(0,l.kt)("li",{parentName:"ul"},"roscpp"),(0,l.kt)("li",{parentName:"ul"},"roslint"),(0,l.kt)("li",{parentName:"ul"},"rm_msgs"),(0,l.kt)("li",{parentName:"ul"},"rm_common"),(0,l.kt)("li",{parentName:"ul"},"pluginlib"),(0,l.kt)("li",{parentName:"ul"},"controller_interface"),(0,l.kt)("li",{parentName:"ul"},"hardware_interface"),(0,l.kt)("li",{parentName:"ul"},"forward_command_controller"),(0,l.kt)("li",{parentName:"ul"},"realtime_tools"),(0,l.kt)("li",{parentName:"ul"},"control_toolbox"),(0,l.kt)("li",{parentName:"ul"},"effort_controllers"),(0,l.kt)("li",{parentName:"ul"},"dynamic_reconfigure")),(0,l.kt)("h4",{id:"building"},"Building"),(0,l.kt)("p",null,"To build this package with catkin build. Clone the latest version from this repository into your catkin workspace."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"catkin_workspace/src\ngit clone https://github.com/rm-controls/rm_controllers.git\nrosdep install --from-paths . --ignore-src\ncatkin build\n")),(0,l.kt)("h2",{id:"usage"},"Usage"),(0,l.kt)("p",null,"Run the controller with mon launch:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"mon launch rm_shooter_controllers load_controllers.launch\n")),(0,l.kt)("h2",{id:"cfg"},"Cfg"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"shooter.cfg:")," Add parameters related to friction wheel's angular velocity corresponding to each bullet speed and trigger block detection parameters.")),(0,l.kt)("h2",{id:"launch-files"},"Launch files"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"load_controller.launch:")," Load the parameters in config files and load the shooter controller.")),(0,l.kt)("h2",{id:"ros-api"},"ROS API"),(0,l.kt)("h4",{id:"subscribed-topics"},"Subscribed Topics"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"command"))," (rm_msgs/ShootCmd)"),(0,l.kt)("p",{parentName:"li"},"Commands of controller state, bullet speed, frequency of shooting."))),(0,l.kt)("h4",{id:"parameters"},"Parameters"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"block_effort"),", ",(0,l.kt)("inlineCode",{parentName:"strong"},"block_speed"),", ",(0,l.kt)("inlineCode",{parentName:"strong"},"block_duration"))," (double)"),(0,l.kt)("p",{parentName:"li"},"When the torque of the trigger motor is greater than ",(0,l.kt)("inlineCode",{parentName:"p"},"block_effort")," (in N\xb7m), and the angular velocity of trigger motor is less than ",(0,l.kt)("inlineCode",{parentName:"p"},"block_speed")," (in rad/s), it will be regarded as blocking if it continues for ",(0,l.kt)("inlineCode",{parentName:"p"},"block_duration")," (in s), and the the state of shooter controller will switch to BLOCK.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"block_overtime"))," (double)"),(0,l.kt)("p",{parentName:"li"},"If the time to enter BLOCK state exceeds ",(0,l.kt)("inlineCode",{parentName:"p"},"block_overtime")," (in s), the state of shooter controller will switch to PUSH.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"anti_block_angle"))," (double)"),(0,l.kt)("p",{parentName:"li"},"If shooter controller enter BLOCK state, the friction wheel will reverse ",(0,l.kt)("inlineCode",{parentName:"p"},"anti_block_angle")," (in rad) to try to get rid of blocking. When the friction wheel get rid of BLOCK state successfully, the state of shooter controller will switch to PUSH.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"anti_block_threshold"))," (double)"),(0,l.kt)("p",{parentName:"li"},"If the anti angle of the friction wheel exceeds ",(0,l.kt)("inlineCode",{parentName:"p"},"anti_block_threshold")," (in rad), it means that friction wheel reverse successfully.")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},(0,l.kt)("strong",{parentName:"p"},(0,l.kt)("inlineCode",{parentName:"strong"},"qd_10"),", ",(0,l.kt)("inlineCode",{parentName:"strong"},"qd_15"),", ",(0,l.kt)("inlineCode",{parentName:"strong"},"qd_18"),", ",(0,l.kt)("inlineCode",{parentName:"strong"},"qd_30"))," (double)"),(0,l.kt)("p",{parentName:"li"},"These parameters mean the friction wheel's angular velocity, the number of it's name expresses different bullet speeds (in m/s)."))),(0,l.kt)("h3",{id:"controller-configuration-examples"},"Controller configuration examples"),(0,l.kt)("h4",{id:"complete-description"},"Complete description"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},'shooter_controller:\n    type: rm_shooter_controllers/Controller\n    publish_rate: 50\n    friction_left:\n      joint: "left_friction_wheel_joint"\n      pid: { p: 0.001, i: 0.01, d: 0.0, i_clamp_max: 0.01, i_clamp_min: -0.01, antiwindup: true, publish_state: true }\n    friction_right:\n      joint: "right_friction_wheel_joint"\n      pid: { p: 0.001, i: 0.01, d: 0.0, i_clamp_max: 0.01, i_clamp_min: -0.01, antiwindup: true, publish_state: true }\n    trigger:\n      joint: "trigger_joint"\n      pid: { p: 50.0, i: 0.0, d: 1.5, i_clamp_max: 0.0, i_clamp_min: 0.0, antiwindup: true, publish_state: true }\n    push_per_rotation: 8\n    push_qd_threshold: 0.90\n    block_effort: 0.95\n    block_duration: 0.05\n    block_overtime: 0.5\n    anti_block_angle: 0.2\n    anti_block_threshold: 0.1\n    qd_15: 460.0\n    qd_18: 515.0\n    qd_30: 740.0\n')),(0,l.kt)("h2",{id:"bugs--feature-requests"},"Bugs & Feature Requests"),(0,l.kt)("p",null,"Please report bugs and request features using the ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/gdut-dynamic-x/simple_chassis_controller/issues"},"Issue Tracker")," ."))}d.isMDXComponent=!0}}]);